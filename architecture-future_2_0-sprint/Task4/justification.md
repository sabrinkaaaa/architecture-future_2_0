# Обоснование конфигурации Terraform + k3s

## Выбор технологий

- **k3s** выбран за его лёгкость в развёртывании и изоляции приложений. Контейнеризация упрощает управление зависимостями и обеспечивает воспроизводимость среды.
- **PostgreSQL** — популярная, надёжная реляционная СУБД с открытым исходным кодом, хорошо подходящая для большинства приложений.
- **Terraform** - средство описания инфраструктуры как кода: конфигурация сети, томов и контейнеров фиксируется в декларативном виде, легко ревьюится и повторно применяется.

## Структура решения

- Создаётся отдельная сеть с подсетью в Yandex Cloud для каждой VM из пула — VM изолирована от остальных VM в пуле.
- Том хранит данные PostgreSQL между перезапусками; демонстрируется управление stateful‑компонентами через IaC.
- Приложение на Go общается с Postgres.
- Под PostgreSQL (`postgres:18`) разворачивается с параметрами из `variables.tf`; открытый порт `5432` позволяет подключаться к БД локальными инструментами.

## Параметризация

- Все критичные параметры выведены в переменные: порты, теги образов, имя/пароль БД, docker host. Это упрощает создание нескольких окружений/namespace (`dev`, `stage`) без изменений кода.
- Значения по умолчанию в `terraform.tfvars` задают типовой стенд, но их легко адаптировать под нужды команды (например, сменить порт или логин).
- Terraform скрывает пароль БД как `sensitive` — он не попадает в вывод `plan/apply`, что повышает безопасность, даже в локальном сценарии.

## Преимущества подхода

- Конфигурация полностью идемпотентна: повторное `terraform apply` приводит среду в ожидаемое состояние, а `terraform destroy` очищает ресурсы.
- Код служит документацией: диаграмма, README и конфигурация точно описывают текущую архитектуру.
- Модель легко масштабируется: при переходе в облако достаточно заменить провайдер и ресурсы, сохранив структуру переменных и модульность.
